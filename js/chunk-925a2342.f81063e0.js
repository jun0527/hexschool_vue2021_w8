(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-925a2342"],{5651:function(t,e,a){"use strict";a.r(e);a("b0c0");var o=a("7a23"),c={class:"py-4"},d=Object(o["h"])("h2",{class:"text-center"},"訂單管理",-1),n={class:"d-flex justify-content-end"},r={class:"table table-hover"},l=Object(o["h"])("thead",null,[Object(o["h"])("tr",null,[Object(o["h"])("th",{width:"10%"},"日期"),Object(o["h"])("th",{width:"10%"},"姓名、電話"),Object(o["h"])("th",{width:"30%"},"email、地址"),Object(o["h"])("th",{width:"10%"},"總金額"),Object(o["h"])("th",{width:"10%"},"是否付款"),Object(o["h"])("th",{width:"20%"},"操作")])],-1),s=Object(o["h"])("br",null,null,-1),i={key:0,class:"loading"},b=Object(o["h"])("div",{class:"icon"},null,-1);function u(t,e,a,u,h,O){var j=Object(o["y"])("Pagination"),p=Object(o["y"])("OrderProductModal"),g=Object(o["y"])("ChangeStatusModal"),f=Object(o["y"])("DeleteModal");return Object(o["t"])(),Object(o["d"])(o["a"],null,[Object(o["h"])("div",c,[d,Object(o["h"])("div",n,[Object(o["h"])("button",{type:"button",class:"btn btn-danger mb-3",onClick:e[1]||(e[1]=function(t){return O.openModal("deleteModal","","deleteAllOrder")}),disabled:0===h.orders.length},"刪除全部",8,["disabled"])]),Object(o["h"])("table",r,[l,Object(o["h"])("tbody",null,[(Object(o["t"])(!0),Object(o["d"])(o["a"],null,Object(o["x"])(h.orders,(function(t,e){return Object(o["t"])(),Object(o["d"])("tr",{class:"align-middle",key:t.id},[Object(o["h"])("td",null,Object(o["B"])(t.date),1),Object(o["h"])("td",null,[Object(o["g"])(Object(o["B"])(t.user.name),1),s,Object(o["g"])(" "+Object(o["B"])(t.user.tel),1)]),Object(o["h"])("td",null,[Object(o["h"])("p",{class:"mb-0",title:t.user.email},Object(o["B"])(t.user.email),9,["title"]),Object(o["h"])("p",{class:"mb-0",title:t.user.address},Object(o["B"])(t.user.address),9,["title"])]),Object(o["h"])("td",null,Object(o["B"])(t.total),1),Object(o["h"])("td",null,[Object(o["h"])("input",{type:"checkbox",class:"checkbox",id:t.id,checked:t.is_paid,onChange:function(t){return O.openModal("changeStatusModal",e)}},null,40,["id","checked","onChange"]),Object(o["h"])("label",{for:t.id,class:"checkbox"},Object(o["B"])(t.is_paid?"已付款":"未付款"),9,["for"])]),Object(o["h"])("td",null,[Object(o["h"])("button",{type:"button",class:"btn btn-outline-primary me-2",onClick:function(t){return O.openModal("productModal",e)}}," 查看訂單產品",8,["onClick"]),Object(o["h"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(t){return O.openModal("deleteModal",e)}}," 刪除",8,["onClick"])])])})),128))])]),Object(o["h"])(j,{paginationData:h.pagination,onGetData:O.getOrdersData},null,8,["paginationData","onGetData"])]),h.getOrdersLoading?(Object(o["t"])(),Object(o["d"])("div",i,[b])):Object(o["e"])("",!0),Object(o["h"])(p,{ref:"productModal"},null,512),Object(o["h"])(g,{ref:"changeStatusModal",onGetOrders:O.getOrdersData},null,8,["onGetOrders"]),Object(o["h"])(f,{ref:"deleteModal",onGetOrder:O.getOrdersData},null,8,["onGetOrder"])],64)}a("99af"),a("159b"),a("fb6a"),a("b64b");var h=a("1940"),O=a.n(h),j={class:"modal fade",ref:"submitModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},p={class:"modal-dialog modal-dialog-scrollable"},g={class:"modal-content"},f={class:"modal-header bg-dark"},M=Object(o["h"])("h5",{class:"modal-title text-white",id:"exampleModalLabel"},"訂單資訊",-1),m={key:0,class:"modal-body"},y=Object(o["h"])("h2",{class:"h4 fw-bold"},"購買資料",-1),v=Object(o["h"])("hr",null,null,-1),k=Object(o["h"])("h2",{class:"h4 fw-bold"},"購買產品",-1),w={class:"modal-footer"};function S(t,e,a,c,d,n){return Object(o["t"])(),Object(o["d"])("div",j,[Object(o["h"])("div",p,[Object(o["h"])("div",g,[Object(o["h"])("div",f,[M,Object(o["h"])("button",{type:"button",class:"btn-close btn-close-white",onClick:e[1]||(e[1]=function(){return n.closeModal&&n.closeModal.apply(n,arguments)})})]),"{}"!==JSON.stringify(d.order)?(Object(o["t"])(),Object(o["d"])("div",m,[y,Object(o["h"])("p",null,"付款日期："+Object(o["B"])(d.paidDate),1),Object(o["h"])("p",null,"訂單編號："+Object(o["B"])(d.order.id),1),Object(o["h"])("p",null,"付款方式："+Object(o["B"])(d.order.user.payment_method),1),Object(o["h"])("p",null,"留言："+Object(o["B"])(d.order.message),1),v,k,(Object(o["t"])(!0),Object(o["d"])(o["a"],null,Object(o["x"])(d.products,(function(t){return Object(o["t"])(),Object(o["d"])("p",{key:t.title},Object(o["B"])(t.title)+" x "+Object(o["B"])(t.qty),1)})),128))])):Object(o["e"])("",!0),Object(o["h"])("div",w,[Object(o["h"])("button",{type:"button",class:"btn btn-outline-dark",onClick:e[2]||(e[2]=function(){return n.closeModal&&n.closeModal.apply(n,arguments)})},"取消")])])])],512)}var D=a("7b17"),x={data:function(){return{orderProductModal:{},order:{},products:[],paidDate:""}},methods:{openModal:function(){this.orderProductModal.show(),this.getProducts()},closeModal:function(){this.order={},this.products=[],this.orderProductModal.hide()},getProducts:function(){var t=this;this.order.cartIds.forEach((function(e){var a={};a.title=t.order.products[e].product.title,a.qty=t.order.products[e].qty,t.products.push(a)}))},getPaidDate:function(){var t=new Date(1e3*this.order.paid_date);this.paidDate="".concat(t.getFullYear(),"/").concat((0+String(t.getMonth()+1)).slice(-2),"/").concat(t.getDate())}},mounted:function(){this.orderProductModal=new D["c"](this.$refs.submitModal,{backdrop:"static",keyboard:!1})}};x.render=S;var C=x,B={class:"modal fade",ref:"modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},$={class:"modal-dialog"},P={class:"modal-content"},_={class:"modal-header bg-dark"},L=Object(o["h"])("h5",{class:"modal-title text-white"},"訂單狀態確認",-1),A={class:"modal-body"},G={key:0},J={key:1},q={class:"modal-footer"};function E(t,e,a,c,d,n){return Object(o["t"])(),Object(o["d"])("div",B,[Object(o["h"])("div",$,[Object(o["h"])("div",P,[Object(o["h"])("div",_,[L,Object(o["h"])("button",{type:"button",class:"btn-close btn-close-white",onClick:e[1]||(e[1]=function(){return n.closeModal&&n.closeModal.apply(n,arguments)})})]),Object(o["h"])("div",A,[d.order.is_paid?(Object(o["t"])(),Object(o["d"])("p",J,"確定要將訂單狀態更改成未付款？")):(Object(o["t"])(),Object(o["d"])("p",G,"確定要將訂單狀態更改成已付款？"))]),Object(o["h"])("div",q,[Object(o["h"])("button",{type:"button",class:"btn btn-outline-dark",onClick:e[2]||(e[2]=function(){return n.closeModal&&n.closeModal.apply(n,arguments)})},"取消"),Object(o["h"])("button",{type:"button",class:"btn btn-danger",onClick:e[3]||(e[3]=function(){return n.changeStatus&&n.changeStatus.apply(n,arguments)})},"確認")])])])],512)}var F=a("5530"),I={data:function(){return{changeStatusModal:{},order:{},page:""}},emits:["getOrders"],methods:{openModal:function(){this.changeStatusModal.show()},closeModal:function(){this.order={},this.changeStatusModal.hide()},changeStatus:function(){var t=this,e={};e.data=Object(F["a"])({},this.order),e.data.is_paid=!e.data.is_paid;var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/order/").concat(this.order.id);this.$http.put(a,e).then((function(e){e.data.success?(O()("更改訂單付款狀態成功！"),t.closeModal(),t.$emit("getOrders",t.page)):(O()("該改訂單付款狀態失敗！"),t.closeModal())})).catch((function(){O()("網頁發生錯誤，請重新整理此頁面！")}))}},mounted:function(){this.changeStatusModal=new D["c"](this.$refs.modal,{backdrop:"static",keyboard:!1})}};I.render=E;var N=I,Y=a("ec05"),T=a("1799"),z={data:function(){return{orders:[],originOrders:[],pagination:{},getOrdersLoading:!0}},components:{OrderProductModal:C,ChangeStatusModal:N,DeleteModal:Y["a"],Pagination:T["a"]},methods:{getOrdersData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.getOrdersLoading=!0,document.documentElement.scrollTop=0;var a="".concat("https://vue3-course-api.hexschool.io/","api/").concat("jun0527","/admin/orders?page=").concat(e);this.$http.get(a).then((function(e){e.data.success?(t.orders=JSON.parse(JSON.stringify(e.data.orders)),t.originOrders=e.data.orders,t.pagination=e.data.pagination,t.orders.forEach((function(e,a){var o=new Date(1e3*e.create_at);t.orders[a].date="".concat(o.getFullYear(),"/").concat((0+String(o.getMonth()+1)).slice(-2),"/").concat(o.getDate());var c=Object.keys(e.products);t.orders[a].cartIds=c})),t.getOrdersLoading=!1):O()("訂單資料讀取失敗！")})).catch((function(){O()("網頁發生錯誤，請重新整理此頁面！")}))},openModal:function(t,e,a){"productModal"===t?(this.$refs.productModal.order=this.orders[e],this.$refs.productModal.getPaidDate()):"changeStatusModal"===t?(this.$refs.changeStatusModal.order=this.originOrders[e],this.$refs.changeStatusModal.page=this.pagination.current_page):"deleteModal"===t&&"deleteAllOrder"===a?this.$refs.deleteModal.deleteStatus=a:"deleteModal"===t&&(this.$refs.deleteModal.deleteStatus=t,this.$refs.deleteModal.deleteOrderId=this.orders[e].id),this.$refs[t].openModal()}},created:function(){this.getOrdersData()}};z.render=u;e["default"]=z},b0c0:function(t,e,a){var o=a("83ab"),c=a("9bf2").f,d=Function.prototype,n=d.toString,r=/^\s*function ([^ (]*)/,l="name";o&&!(l in d)&&c(d,l,{configurable:!0,get:function(){try{return n.call(this).match(r)[1]}catch(t){return""}}})},fb6a:function(t,e,a){"use strict";var o=a("23e7"),c=a("861d"),d=a("e8b5"),n=a("23cb"),r=a("50c4"),l=a("fc6a"),s=a("8418"),i=a("b622"),b=a("1dde"),u=b("slice"),h=i("species"),O=[].slice,j=Math.max;o({target:"Array",proto:!0,forced:!u},{slice:function(t,e){var a,o,i,b=l(this),u=r(b.length),p=n(t,u),g=n(void 0===e?u:e,u);if(d(b)&&(a=b.constructor,"function"!=typeof a||a!==Array&&!d(a.prototype)?c(a)&&(a=a[h],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return O.call(b,p,g);for(o=new(void 0===a?Array:a)(j(g-p,0)),i=0;p<g;p++,i++)p in b&&s(o,i,b[p]);return o.length=i,o}})}}]);
//# sourceMappingURL=chunk-925a2342.f81063e0.js.map